---
description: Permission Management and Access Control
globs: 
---
Role-Based Access:
- Define UserRole enum in Prisma schema
- Implement role checks in middleware
- Use RoleGuard component for UI protection
- Handle multiple roles per user
- Follow principle of least privilege

Permission Guards:
- Use PermissionGuard for granular control
- Check resource-specific permissions
- Implement proper fallbacks
- Handle unauthorized states
- Document permission requirements

Server-Side Protection:
- Check permissions in server actions
- Implement proper error responses
- Use checkAuth utility
- Handle resource ownership
- Follow RBAC best practices

Client-Side Guards:
- Use hasPermission utility
- Implement UI-level protection
- Handle loading states
- Show appropriate error messages
- Follow consistent patterns 